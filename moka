blepha_final <- read.table("~/MEGA/Doctorado/Semetre 7/Seminario VII/blepha_final.nex", quote="\"")
distribucion_ble <- read.csv("~/MEGA/Doctorado/Semetre 7/Seminario VII/distribucion_ble.csv")

library(ape)
library(maps)
library(phytools)
library(mapdata)


data <- read.csv("distribucion_ble.csv")[,1:3]
row.names(data) <- data$spp
data$spp  <- NULL

tree <- read.nexus("blepha_final.nex")

tree$tip.label
data$spp
obj<-phylo.to.map(tree,data, plot=FALSE)

#NEXUS
[written Tue Feb 21 14:05:26 COT 2023 by Mesquite  version 3.6 (build 917) at DESKTOP-VI5651V/10.44.22.120]

BEGIN TAXA;
	TITLE Taxa;
	DIMENSIONS NTAX=27;
	TAXLABELS
		OUTGROUP rupta MEX035_spn_isabelae MEX008_nr_splendida MEX034_spn_xalapensis MEX003_nr_ruptafascia COL020_spn_ranulfoi MEX039_spn_dzuli cyclantherae MEX024_io MEX025_mexicana MEX027_quadristriata MEX023_femoralis femoralis MEX009_splendida MEX010_punctistigma aspiculosa MEX021_spn_martyae biseriata osmundsonae MEX001_nr_biseriata regina MEX002_spn_zapoteca variabilis MEX017_spn_alleni MEX006_diva MEX026_poecilosoma 
	;

END;


BEGIN TREES;
	Title 'Trees from "tree14.nex"';
	ID 01867555f7493;
	LINK Taxa = Taxa;
	TRANSLATE
[0] 		1 OUTGROUP,
[1] 		2 rupta,
[2] 		3 MEX035_spn_isabelae,
[3] 		4 MEX008_nr_splendida,
[4] 		5 MEX034_spn_xalapensis,
[5] 		6 MEX003_nr_ruptafascia,
[6] 		7 COL020_spn_ranulfoi,
[7] 		8 MEX039_spn_dzuli,
[8] 		9 cyclantherae,
[9] 		10 MEX024_io,
[10] 		11 MEX025_mexicana,
[11] 		12 MEX027_quadristriata,
[12] 		13 MEX023_femoralis,
[13] 		14 femoralis,
[14] 		15 MEX009_splendida,
[15] 		16 MEX010_punctistigma,
[16] 		17 aspiculosa,
[17] 		18 MEX021_spn_martyae,
[18] 		19 biseriata,
[19] 		20 osmundsonae,
[20] 		21 MEX001_nr_biseriata,
[21] 		22 regina,
[22] 		23 MEX002_spn_zapoteca,
[23] 		24 variabilis,
[24] 		25 MEX017_spn_alleni,
[25] 		26 MEX006_diva,
[26] 		27 MEX026_poecilosoma;
	TREE tagged_tree = (1,(2,(3,(4,(5,(6,7,8,(26,27),(9,10,11,12,(24,25),(13,((14,(15,(16,(17,18)))),(19,(20,(21,(22,23)))))))))))));


END;


Begin MESQUITE;
		MESQUITESCRIPTVERSION 2;
		TITLE AUTO;
		tell ProjectCoordinator;
		timeSaved 1677006326834;
		getEmployee #mesquite.minimal.ManageTaxa.ManageTaxa;
		tell It;
			setID 0 4738756384408328723;
		endTell;
		getWindow;
		tell It;
			suppress;
			setResourcesState false false 285;
			setPopoutState 300;
			setExplanationSize 0;
			setAnnotationSize 0;
			setFontIncAnnot 0;
			setFontIncExp 0;
			setSize 1920 940;
			setLocation -9 0;
			setFont Default;
			setFontSize 12;
			getToolPalette;
			tell It;
			endTell;
			desuppress;
		endTell;
		getEmployee  #mesquite.minimal.ManageTaxa.ManageTaxa;
		tell It;
			showTaxa #4738756384408328723 #mesquite.lists.TaxonList.TaxonList;
			tell It;
				setTaxa #4738756384408328723;
				getWindow;
				tell It;
					useTargetValue off;
					setTargetValue ;
					newAssistant  #mesquite.lists.TaxonListCurrPartition.TaxonListCurrPartition;
					setExplanationSize 30;
					setAnnotationSize 20;
					setFontIncAnnot 0;
					setFontIncExp 0;
					setSize 1635 868;
					setLocation -9 0;
					setFont Default;
					setFontSize 12;
					getToolPalette;
					tell It;
					endTell;
				endTell;
				showWindow;
				getEmployee #mesquite.lists.ColorTaxon.ColorTaxon;
				tell It;
					setColor Red;
					removeColor off;
				endTell;
				getEmployee #mesquite.lists.TaxonListAnnotPanel.TaxonListAnnotPanel;
				tell It;
					togglePanel off;
				endTell;
			endTell;
		endTell;
		getEmployee  #mesquite.trees.BasicTreeWindowCoord.BasicTreeWindowCoord;
		tell It;
			makeTreeWindow #4738756384408328723  #mesquite.trees.BasicTreeWindowMaker.BasicTreeWindowMaker;
			tell It;
				suppressEPCResponse;
				setTreeSource  #mesquite.trees.StoredTrees.StoredTrees;
				tell It;
					setTreeBlock 1;
					setTreeBlockID 01867555f7493;
					toggleUseWeights off;
				endTell;
				setAssignedID 1101.1677005817393.8045649183580565913;
				getTreeWindow;
				tell It;
					setExplanationSize 30;
					setAnnotationSize 20;
					setFontIncAnnot 0;
					setFontIncExp 0;
					setSize 1635 868;
					setLocation -9 0;
					setFont Default;
					setFontSize 12;
					getToolPalette;
					tell It;
						setTool mesquite.trees.BasicTreeWindowMaker.BasicTreeWindow.arrow;
					endTell;
					setActive;
					getTreeDrawCoordinator #mesquite.trees.BasicTreeDrawCoordinator.BasicTreeDrawCoordinator;
				tell It;
					suppress;
					setTreeDrawer  #mesquite.trees.SquareLineTree.SquareLineTree;
					tell It;
						setNodeLocs #mesquite.trees.NodeLocsStandard.NodeLocsStandard;
						tell It;
							branchLengthsToggle off;
							toggleScale on;
							toggleBroadScale off;
							toggleCenter on;
							toggleEven on;
							setFixedTaxonDistance 0;
						endTell;
						setEdgeWidth 4;
						showEdgeLines on;
						orientRight;
					endTell;
					setBackground White;
					setBranchColor Black;
					showNodeNumbers off;
					showBranchColors on;
					labelBranchLengths off;
					centerBrLenLabels on;
					showBrLensUnspecified on;
					showBrLenLabelsOnTerminals on;
					setBrLenLabelColor 0 0 255;
					setNumBrLenDecimals 6;
					setSelectedTaxonHighlightMode 1;
					desuppress;
					getEmployee #mesquite.trees.BasicDrawTaxonNames.BasicDrawTaxonNames;
					tell It;
						setColor Black;
						setTaxonNameStyler  #mesquite.trees.NoColorForTaxon.NoColorForTaxon;
						toggleShadePartition off;
						toggleShowFootnotes on;
						toggleNodeLabels on;
						toggleCenterNodeNames off;
						toggleShowNames on;
						namesAngle ?;
					endTell;
				endTell;
					setTreeNumber 1;
					setDrawingSizeMode 0;
					toggleLegendFloat on;
					scale 0;
					toggleTextOnTree off;
					togglePrintName off;
					showWindow;
				endTell;
				desuppressEPCResponse;
				getEmployee #mesquite.trees.ColorBranches.ColorBranches;
				tell It;
					setColor Red;
					removeColor off;
				endTell;
				getEmployee #mesquite.ornamental.BranchNotes.BranchNotes;
				tell It;
					setAlwaysOn off;
				endTell;
				getEmployee #mesquite.ornamental.ColorTreeByPartition.ColorTreeByPartition;
				tell It;
					colorByPartition off;
				endTell;
				getEmployee #mesquite.ornamental.DrawTreeAssocDoubles.DrawTreeAssocDoubles;
				tell It;
					setOn on;
					toggleShow consensusFrequency;
					toggleShow posteriorProbability;
					toggleShow bootstrapFrequency;
					toggleShow consensusFrequency;
					toggleShow posteriorProbability;
					toggleShow bootstrapFrequency;
					setDigits 4;
					setThreshold ?;
					writeAsPercentage off;
					toggleCentred off;
					toggleHorizontal on;
					toggleWhiteEdges on;
					toggleShowOnTerminals on;
					setFontSize 10;
					setOffset 0  0;
				endTell;
				getEmployee #mesquite.ornamental.DrawTreeAssocStrings.DrawTreeAssocStrings;
				tell It;
					setOn on;
					toggleCentred on;
					toggleHorizontal on;
					setFontSize 10;
					setOffset 0  0;
					toggleShowOnTerminals on;
				endTell;
				getEmployee #mesquite.trees.TreeInfoValues.TreeInfoValues;
				tell It;
					panelOpen false;
				endTell;
			endTell;
		endTell;
		endTell;
end;



plot(obj,ftype="i")

spp,lat,long
rupta,10.6605277,-85.071308
rupta,16.81166,-88.4016027
rupta,17.55,-92.95
MEX035_spn_isabelae,19.36351667,-96.87950833
MEX008_nr_splendida,19.1775,-96.97222222
MEX034_spn_xalapensis,19.50911111,-96.94319444
MEX034_spn_xalapensis,19.51213056,-96.9421
MEX003_nr_ruptafascia,19.46638889,-96.93416667
COL20_spn_ranulfoi,3.551916667,-76.88683333
MEX039_spn_dzuli,19.36351667,-96.87950833
MEX006_diva,3.02825,-76.4127
MEX006_diva,3.3454,-76.5869
MEX006_diva,3.63,-76.255
MEX006_diva,6.315555556,-76.13416667
MEX006_diva,14.81416667,-92.33972222
MEX006_diva,17.54527778,-99.13694444
MEX006_diva,18.23489722,-100.9036778
MEX006_diva,18.30901389,-97.54525833
MEX006_diva,18.90583333,-100.1527778
MEX006_diva,19.14888889,-102.3288889
MEX006_diva,19.1775,-96.97222222
MEX006_diva,19.18166667,-96.97416667
MEX006_diva,19.19083333,-96.98833333
MEX006_diva,19.20611111,-96.88444444
MEX006_diva,19.21333333,-96.88055556
MEX006_diva,19.26766389,-96.84998056
MEX006_diva,19.32055556,-96.71805556
MEX006_diva,19.35166667,-104.9433333
MEX006_diva,19.36351667,-96.87950833
MEX006_diva,19.365075,-96.88876667
MEX006_diva,19.369968,-96.681938
MEX006_diva,19.37027778,-96.88083333
MEX006_diva,19.37086111,-96.68205278
MEX006_diva,19.42916667,-96.96416667
MEX006_diva,19.45194444,-96.93805556
MEX006_diva,19.45605556,-96.93347222
MEX006_diva,19.46638889,-96.93416667
MEX006_diva,19.50911111,-96.94319444
MEX006_diva,19.51213056,-96.9421
MEX006_diva,19.513565,-96.940872
MEX006_diva,19.535,-96.825
MEX006_diva,19.53833333,-96.94
MEX006_diva,19.54,-96.9275
MEX006_diva,19.61194444,-96.85944444
MEX006_diva,19.68536111,-96.85402222
MEX006_diva,19.77083333,-97.28194444
MEX006_diva,21.66638889,-104.8402778
MEX026_poecilosoma,19.2375,-104.5619444
MEX026_poecilosoma,14.81416667,-92.33972222
MEX026_poecilosoma,16.58861111,-95.19222222
MEX026_poecilosoma,19.32055556,-96.71805556
MEX026_poecilosoma,19.08805556,-102.3508333
MEX026_poecilosoma,18.44861111,-95.06388889
MEX026_poecilosoma,18.05956,-96.64557778
MEX026_poecilosoma,19.71888889,-104.6019444
MEX026_poecilosoma,19.37086111,-96.68205278
MEX026_poecilosoma,18.65444444,-102.1130556
MEX026_poecilosoma,19.36351667,-96.87950833
MEX026_poecilosoma,18.3625,-99.5075
MEX026_poecilosoma,18.28638889,-99.46333333
MEX026_poecilosoma,17.54527778,-99.13694444
MEX026_poecilosoma,19.42916667,-96.96416667
MEX026_poecilosoma,19.38138889,-96.98805556
MEX026_poecilosoma,17.65777778,-99.67638889
MEX026_poecilosoma,19.38305556,-96.99972222
MEX026_poecilosoma,19.50911111,-96.94319444
MEX026_poecilosoma,19.51211111,-96.9421
MEX026_poecilosoma,19.51213056,-96.9421
MEX026_poecilosoma,17.64083333,-99.65527778
MEX026_poecilosoma,19.19083333,-96.98833333
MEX026_poecilosoma,19.41666667,-101.9111111
MEX026_poecilosoma,19.53833333,-96.94
MEX026_poecilosoma,19.65083333,-102.4211111
MEX026_poecilosoma,19.38611111,-101.8041667
MEX026_poecilosoma,6.315555556,-76.13416667
MEX026_poecilosoma,19.672,-101.152
MEX026_poecilosoma,18.89194444,-98.72944444
cyclantherae,19.0016,-99.2594
MEX024_io,19.19083333,-96.98833333
MEX024_io,19.46638889,-96.93416667
MEX024_io,18.81666,-97.01666
MEX025_mexicana,14.40511,-90.53711
MEX025_mexicana,17.54527778,-99.13694444
MEX025_mexicana,19.39968,-99.1885
MEX025_mexicana,19.4326,-99.1332
MEX025_mexicana,19.46161,-98.8921
MEX025_mexicana,19.4798,-99.1919
MEX025_mexicana,19.48954,-98.89418
MEX025_mexicana,20.55,-102.5083333
MEX025_mexicana,21.36346,-102.84366
MEX027_quadristriata,10.715738,-85.011125
MEX027_quadristriata,14.5090527,-91.15149722
MEX027_quadristriata,14.5418,-91.1973
MEX027_quadristriata,15.778925,-91.86688
MEX027_quadristriata,17.567105,-92.95
MEX027_quadristriata,18.4193027,-95.1001416
MEX027_quadristriata,18.57653,-95.082619
MEX027_quadristriata,18.584899,-95.07393
MEX027_quadristriata,19.51213056,-96.9421
MEX027_quadristriata,19.54,-96.9275
variabilis,15.6666,-92.75
MEX017_spn_alleni,19.24138889,-97.19833333
MEX017_spn_alleni,19.25333333,-97.18138889
MEX017_spn_alleni,19.535,-96.825
MEX017_spn_alleni,19.54,-96.9275
MEX023_femoralis,15.6666,-92.75
MEX023_femoralis,16.7335,-92.6272
MEX023_femoralis,16.7503,-92.6268
MEX023_femoralis,16.7532,-92.6297
MEX023_femoralis,17.141325,-96.66915
MEX023_femoralis,17.5,-99.6761
MEX023_femoralis,18.7822,-97.4296
MEX023_femoralis,19.0487,-99.3139
MEX023_femoralis,19.40209722,-102.0744444
MEX023_femoralis,19.4326,-99.1332
MEX023_femoralis,19.4798,-99.1919
MEX023_femoralis,19.543775,-96.91018
biseriata,19.2833,-99.15
biseriata,17.76551,-100.6625
osmundsonae,19.35749,-99.827
osmundsonae,19.18333,-100.13333
MEX001_nr_biseriata,19.24138889,-97.19833333
regina,20.1095527,-99.916016
regina,19.0487,-99.3139
regina,19.07473333,-99.33288611
regina,18.7822,-97.4296
MEX002_spn_zapoteca,17.84166667,-96.88055556
femoralis,-27.1833,-52.3833
femoralis,-25.4269,-49.2617
femoralis,-23.4543,-46.6361
femoralis,-22.3272,-44.6092
femoralis,-16.3666,-67.5
femoralis,-13.73956,-76.19678
femoralis,-13.16314,-72.54496
femoralis,-11.09645,-75.30446
femoralis,-7.14394,-78.4948
femoralis,10.51657,-66.85786
femoralis,15.4651,-90.3843
MEX009_splendida,-0.6883,-77.7342416
MEX009_splendida,-0.12425,-78.6291249
MEX009_splendida,9.55,-83.8
MEX009_splendida,9.93295,-67.59536
MEX009_splendida,10.05,-84.01666
MEX009_splendida,10.1756916,-63.50685
MEX009_splendida,10.715738,-85.011125
MEX009_splendida,14.4,-90.7
MEX009_splendida,14.5572,-90.4653
MEX009_splendida,15.6023194,-92.0416916
MEX009_splendida,15.795719,-91.941358
MEX009_splendida,18.387275,-95.2013027
MEX009_splendida,18.57653,-95.082619
MEX009_splendida,18.584899,-95.07393
MEX009_splendida,19.21583333,-96.88527778
MEX009_splendida,19.42916667,-96.96416667
MEX009_splendida,19.45694444,-96.95805556
MEX009_splendida,19.46638889,-96.93416667
MEX009_splendida,19.51213056,-96.9421
MEX009_splendida,19.5129,-96.9467
MEX009_splendida,21.39483,-98.997438
MEX009_splendida,21.5038,-105.1583
MEX009_splendida,23.065108,-99.130258
MEX009_splendida,23.1424,-99.2104027
MEX010_punctistigma,9.924616,-83.879647
MEX010_punctistigma,14.479497,-90.62187
MEX010_punctistigma,14.479497,-90.62187
MEX010_punctistigma,14.5564,-90.4635
MEX010_punctistigma,15.094058,-90.23811
MEX010_punctistigma,15.6666,-92.75
MEX010_punctistigma,18.57653,-95.082619
MEX010_punctistigma,18.584899,-95.07393
MEX010_punctistigma,18.66645556,-97.000055
MEX010_punctistigma,18.66684722,-97.00012222
MEX010_punctistigma,18.72944444,-97.07027778
MEX010_punctistigma,19.18166667,-96.97416667
MEX010_punctistigma,19.19083333,-96.98833333
MEX010_punctistigma,19.46638889,-96.93416667
MEX010_punctistigma,19.535,-96.825
MEX010_punctistigma,19.543775,-96.91018
MEX010_punctistigma,20.52186,-96.99083
aspiculosa,15.66666667,-92.8
MEX021_spn_martyae,18.652975,-96.99744722
MEX021_spn_martyae,18.66684722,-97.00012222
MEX021_spn_martyae,18.72944444,-97.07027778
MEX021_spn_martyae,19.54,-96.9275


